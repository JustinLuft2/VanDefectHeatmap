import * as d3 from "d3";
import { VisualSettings } from "./settings";
import powerbi from "powerbi-visuals-api";
import "./style/visual.less";

export interface DefectData {
    x: number; // x coordinate as % of image width (0–100)
    y: number; // y coordinate as % of image height (0–100)
}

// Paste your base64-encoded van_front.png here
const VAN_IMAGE_BASE64 = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAeAB4AAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCAF/AkoDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9U6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKrWt9HdyzxoG3QtsbI7+1AFmiiigAooooAKKimuI7dd0jhRVL/hItO8x4/tSeYmNy9xkZFAGlRWY3iKxX/ltn6Cmt4msF/wCWjH8KANWisj/hKLH+8/8A3zTH8WWSfwzN/uoP8aANqkzWE3i+1/ghnb6qP8aj/wCEuTtaS/lQB0OaWud/4S5f+fSX8qY3i5/4bKT86AOlorlX8WTH/lwZvq+P6Uz/AISy4X7um/8AkQ/4UAdbRXJHxhe9tNA/7aH/AAqL/hLtS7WSj/gX/wBagDsqK44eKtTP/LpGP+Bf/Wpf+Eo1P/n2i/M/4UAdhRXHf8JNqrdLaH9ax5PGevxeJ4tP+zW4gmtzKHBJbcCcjGPTFAHpNFcV/wAJFrY/5YQ0v/CRa3/zwg/WgDtKQ1xn/CQa4f8AlnAv/Ac0f29rn/TuPqn/ANegDst1G6uO/tzXP79t/wB8Gj+3Nc/v23/fBoA7HdRurjf7e1v+/bf98Gk/t7W/79t/3waAOzDU6uK/t7W/79t/3waP+Eg1r+9b/wDfB/xoA7WiuL/t7V/70H/fJo/t7Vv70P5GgDtKK4v+3tW/vQ/kaVdf1YdWh/75oA7OiuQ/4SLU/wDpif8AgNN/4SbU+8MP4H/61AHY0VweqeL9UstPnuEto5niHmFS2PlAyccda09F8aR6pDFI8TIswDIy8jpzmgDqaKijkD4IORUtABRRRQAU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gA/Cn0UAR7RRtqSigBq06iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD//Z"; // truncated

export class Visual implements powerbi.extensibility.visual.IVisual {
    private target: HTMLElement;
    private settings: VisualSettings;
    private svg: d3.Selection<SVGSVGElement, unknown, null, undefined>;
    private image: d3.Selection<SVGImageElement, unknown, null, undefined>;

    private width: number;
    private height: number;

    constructor(options: powerbi.extensibility.visual.VisualConstructorOptions) {
        this.target = options.element;

        this.width = this.target.clientWidth || 500;
        this.height = this.target.clientHeight || 500;

        // Create scalable SVG
        this.svg = d3.select(this.target)
            .append("svg")
            .attr("width", "100%")
            .attr("height", "100%")
            .attr("viewBox", `0 0 ${this.width} ${this.height}`)
            .style("display", "block");

        // Load van image
        this.image = this.svg.append("image")
            .attr("href", VAN_IMAGE_BASE64)
            .attr("x", 0)
            .attr("y", 0)
            .attr("width", this.width)
            .attr("height", this.height)
            .attr("preserveAspectRatio", "xMidYMid meet")
            .on("load", () => console.log("Van image loaded!"))
            .on("error", () => console.error("Failed to load van image!"));
    }

    public update(options: powerbi.extensibility.visual.VisualUpdateOptions) {
        console.log("Updating visual...");

        if (!options.dataViews || !options.dataViews[0]) {
            console.warn("No data view available.");
            return;
        }

        // Update container size
        this.width = this.target.clientWidth || 500;
        this.height = this.target.clientHeight || 500;
        this.svg.attr("viewBox", `0 0 ${this.width} ${this.height}`);
        this.image.attr("width", this.width).attr("height", this.height);

        // Get current settings
        this.settings = VisualSettings.fromDataView(options.dataViews[0]);

        // Extract X and Y columns from categorical categories
        const categorical = options.dataViews[0].categorical;
        const categories = categorical?.categories || [];

        if (categories.length < 2) {
            console.warn("Expected 2 category fields (x, y), found:", categories.length);
            return;
        }

        const xValues = categories[0].values;
        const yValues = categories[1].values;

        const defects: DefectData[] = xValues.map((xVal: any, i: number) => {
            const x = Number(xVal);
            const y = Number(yValues[i]);
            if (isNaN(x) || isNaN(y)) {
                console.warn(`Invalid defect at index ${i}: x=${xVal}, y=${yValues[i]}`);
            }
            return { x: isNaN(x) ? 0 : x, y: isNaN(y) ? 0 : y };
        });

        console.log("Defects parsed:", defects);

        // Bind data to circles
        const markers = this.svg.selectAll<SVGCircleElement, DefectData>("circle")
            .data(defects, (_d, i) => i);

        markers.exit().remove();

        markers.enter()
            .append("circle")
            .merge(markers)
            .attr("cx", d => (d.x / 100) * this.width)
            .attr("cy", d => (d.y / 100) * this.height)
            .attr("r", this.settings.markers.markerSize)
            .attr("fill", this.settings.markers.markerColor);
    }
}
